<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriSphere: Daily Trackers</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}"> <!-- Link to CSS file for styling -->
    
    <script language="JavaScript">
        // dynamically populates calorie goal on Add New Tracker form when a user is selected from the dropdown
        function getSelectedUser() {
            let selectedUser = document.getElementById("selectedUser");
            let userID = selectedUser.value;
            let username = selectedUser.options[selectedUser.selectedIndex].getAttribute("data-username")
            let calorieGoal = selectedUser.options[selectedUser.selectedIndex].getAttribute("data-calorie-goal")
            console.log("selectedUser:", userID, username, calorieGoal)
            
            // populates default field value for Calorie Goal in Add Daily Tracker form
            document.getElementById("calorieGoal").value = calorieGoal
        }
    </script>
</head>
<body>
    <!-- Navigation Bar -->
    <header>
        <h1>NutriSphere: Daily Trackers</h1>
        <nav>
            <a href="{{ url_for('home') }}">üè† Home</a>
            <a href="{{ url_for('users') }}">üë§ Users</a>
            <a href="{{ url_for('daily_trackers') }}">üóìÔ∏è Daily Trackers</a>
            <a href="{{ url_for('food_entries') }}">üçΩÔ∏è Food Entries</a>
            <a href="{{ url_for('food_items') }}">ü•ó Food Items</a>
            <a href="{{ url_for('exercises') }}">üèãÔ∏è Exercises</a>
        </nav>
    </header>

    <!-- Daily Trackers Table Section -->
    <main id="daily-trackers-table">
        <h2>Daily Trackers</h2>
        <table border="1">
            <thead>
                <!-- Access queried table headers passed from daily-trackers route -->
                <tr>
                    {% for key in daily_trackers[0].keys() %}
                    <th>{{ key }}</th>
                    {% endfor %}
                    <th>Actions</th>
                </tr>
            </thead>

            <!-- Access queried table data passed from daily-trackers route -->
            <tbody>
                {% for tracker in daily_trackers %}
                <tr>
                    {% for key in tracker.keys() %}
                    <td> {{tracker[key]}} </td>
                    {% endfor %} 
                    <td>
                        <button class="edit-btn">‚úèÔ∏è Edit</button>
                        <button class="delete-btn">‚ùå Delete</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </main>

    <!-- Add Daily Tracker Form -->
    <section id="add-daily-tracker">
        <form action="/daily-trackers" method="post">
            <fieldset>
                <h2>Add New Daily Tracker</h2>
                <label>Select a User</label>
                <select id="selectedUser" onchange="getSelectedUser()">
                    <option value="" selected disabled hidden></option>
                    {% for user in users %}
                    <option 
                        value="{{ user.userID }}"
                        data-username="{{ user.username }}"
                        data-calorie-goal="{{ user.dailyCalorieGoal }}"
                    >
                        {{ user.username }}
                    </option>
                    {% endfor %}
                </select>

                <label>Date</label>
                <input type="date">

                <label>Calorie Goal</label>
                <input id="calorieGoal" type="number" value="">

                <label>Exercise</label>
                <select>
                    <option value="NULL" selected></option>
                    {% for exercise in exercises %}
                    <option value={{ exercise.exerciseID }}>{{ exercise.name }}</option>
                    {% endfor %}
                </select>

                <button>Add</button>

                <p>Note: Calories consumed, calories burned, and calories remaining would be calculated and populated
                    through a query after adding a daily tracker.</p>
            </fieldset>
        </form>
    </section>

    <!-- Update Daily Tracker Form -->
    <section id="update-daily-tracker">
        <form action="#">
            <fieldset>
                <h2>Update Daily Tracker</h2>
                <label>Select a Daily Tracker:</label>
                <select>
                    <option>1: Tyler, 2025-01-02</option>
                    <option>2: Tyler, 2025-01-03</option>
                    <option>3: Jane, 2025-01-20</option>
                </select>
                <label>Username:</label>
                <select>
                    <option>Tyler</option>
                    <option>Jane</option>
                    <option>Alex</option>
                </select>
                <label>Date:</label>
                <input type="date" value="2025-01-02">
                <label>Calorie Goal</label>
                <input type="number" value="2400">
                <label>Exercise</label>
                <select>
                    <option>Elliptical</option>
                    <option>Hiking</option>
                    <option>Swimming</option>
                    <option>Pickleball</option>
                </select>

                <button>Save</button>

                <p>Note: Calories consumed, calories burned, and calories remaining would be auto-calculated through a query after updating a daily tracker.</p>
            </fieldset>
        </form>
    </section>

    <!-- Delete Daily Tracker Form -->
    <section id="delete-daily-tracker">
        <form action="#">
            <fieldset>
                <h2>Delete Daily Tracker</h2>
                <p>Are you sure you want to delete this?</p>
                <label>Daily Tracker ID:</label>
                <input type="number" value="1" disabled />
                <label>Username:</label>
                <input type="text" value="Tyler" disabled />
                <label>Date:</label>
                <input type="date" value="2025-01-02" disabled/>
                <label>Exercise:</label>
                <select disabled>
                    <option>Elliptical</option>
                </select>
                <button>Delete</button>
            </fieldset>
        </form>
    </section>


    <!-- <script>
        function showUpdateForm() {
            let updateForm = document.getElementById("update-daily-tracker");
            let deleteForm = document.getElementById("delete-daily-tracker");
            if (updateForm.style.display = "none") {
                updateForm.style.display = "block";
                document.getElementById("daily-trackers-table").style.display = "none";
                document.getElementById("add-daily-tracker").style.display = "none";
            } else if (deleteForm.style.display = "none") {
                deleteForm.style.display = "block";
                document.getElementById("daily-trackers-table").style.display = "none";
                document.getElementById("add-daily-tracker").style.display = "none";
            }
            else {
                updateForm.style.display = "none"
            }
        }
        function showDeleteForm() {
            let deleteForm = document.getElementById("delete-daily-tracker");
            if (deleteForm.style.display = "none") {
                deleteForm.style.display = "block";
                document.getElementById("daily-trackers-table").style.display = "none";
                document.getElementById("add-daily-tracker").style.display = "none";
            }
            else {
                updateForm.style.display = "none"
            }
        }
    </script> -->

</body>
</html>
